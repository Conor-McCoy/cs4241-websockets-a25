<html lang="en">
  <head>
    <style>
      body { 
        margin:0; 
        background:black 
      } 
    </style>
    <script>
      let ws, msgs = [], ctx = null
      
      window.onload = function() {
        ws = new WebSocket( 'ws://127.0.0.1:3000' )

        ws.onopen = () => {
          ws.onmessage = async msg => {
            const pos = await msg.data.text()
            const [x,y] = pos.split( ':' ).map( v => parseInt(v) )

            
            ctx.beginPath();
            ctx.lineWidth = 5;
            ctx.strokeStyle = 'red';
            ctx.lineCap = 'round';
            ctx.moveTo(x, y);
            const position = msg.data.text()
            const [newX, newY] = pos.split( ':' ).map(v => parseInt(v) );
            ctx.lineTo(newX,newY);
            ctx.stroke();
          }
        }

        const canvas = document.querySelector('canvas')
        canvas.width = window.innerWidth
        canvas.height = window.innerHeight
        let x = 0;
        let y = 0;
        let isDrawing = false;
        ctx = canvas.getContext( '2d' )

        window.addEventListener("mousedown", (e) => {
          isDrawing = true;
          const position = {x: e.pageX, y: e.pageY};
          x= position.x;
          y= position.y;
          ws.send(`${x}:${y}`)
        //   ctx.fillStyle = 'yellow'
        //   ctx.fillRect( e.pageX,e.pageY,50,50 )
        })
        let coord_array = [];
        window.addEventListener("mousemove", (e) => {
            if (!isDrawing) return; 
            const position = {x: e.pageX ,y: e.pageY};
            ws.send(`${x}:${y}`)
            ctx.beginPath();
            ctx.lineWidth = 5;
            ctx.strokeStyle = 'white';
            ctx.lineCap = 'round';
            ctx.moveTo(x, y);
            x=(position.x);
            y= position.y;
            ctx.lineTo(x,y);
            ctx.stroke();
        });
        window.addEventListener("mouseup", (e) =>{
            isDrawing = false;
        });
    }
    </script>
  </head>
  <body>
    <canvas></canvas>
  </body>
</html>